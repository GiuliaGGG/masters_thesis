###################################################
### chunk number 3:
###################################################
dataprep.out <- dataprep(
foo = df_clean,
predictors = c("assets", "employees", "gross_margin_pct", "net_margin_pct",
"r_and_d", "long_term_debt", "operating_expenses"),
predictors.op = "mean",
time.predictors.prior = 2021:2023,  # pre-boycott quarters
special.predictors = list(
list("revenue", 2021:2020, "mean"),   # Include mean past revenue
list("net_income", 2021:2020, "mean")
),
dependent = "revenue",
unit.variable = "company_id",
unit.names.variable = "ticker",
time.variable = "year",
treatment.identifier = 1,         # Boycotted company
controls.identifier = c(2:20),    # Non-boycotted companies
time.optimize.ssr = 2021:2020,
time.plot = 2021:2025
)
###################################################
### chunk number 2:
###################################################
df_clean[85:89, 1:4]
# Step 2: Convert all other columns to numeric
df_clean <- df %>%
mutate(across(
.cols = -all_of(id_cols),          # all columns except identifiers
.fns  = ~ suppressWarnings(as.numeric(.))  # convert to numeric, quietly
))
###################################################
### chunk number 2:
###################################################
df_clean[85:89, 1:4]
###################################################
### chunk number 3:
###################################################
dataprep.out <- dataprep(
foo = df_clean,
predictors = c("assets", "employees", "gross_margin_pct", "net_margin_pct",
"r_and_d", "long_term_debt", "operating_expenses"),
predictors.op = "mean",
time.predictors.prior = 2021:2023,  # pre-boycott quarters
special.predictors = list(
list("revenue", 2021:2020, "mean"),   # Include mean past revenue
list("net_income", 2021:2020, "mean")
),
dependent = "revenue",
unit.variable = "company_id",
unit.names.variable = "ticker",
time.variable = "year",
treatment.identifier = 1,         # Boycotted company
controls.identifier = c(2:20),    # Non-boycotted companies
time.optimize.ssr = 2021:2020,
time.plot = 2021:2025
)
# Step 2: Convert all other columns to numeric
df_clean <- df %>%
mutate(across(
.cols = -all_of(id_cols),          # all columns except identifiers
.fns  = ~ as.numeric(.)  # convert to numeric, quietly
))
df_clean
###################################################
### chunk number 3:
###################################################
dataprep.out <- dataprep(
foo = df_clean,
predictors = c("assets", "employees", "gross_margin_pct", "net_margin_pct",
"r_and_d", "long_term_debt", "operating_expenses"),
predictors.op = "mean",
time.predictors.prior = 2021:2023,  # pre-boycott quarters
special.predictors = list(
list("revenue", 2021:2020, "mean"),   # Include mean past revenue
list("net_income", 2021:2020, "mean")
),
dependent = "revenue",
unit.variable = "company_id",
unit.names.variable = "ticker",
time.variable = "year",
treatment.identifier = 1,         # Boycotted company
controls.identifier = c(2:20),    # Non-boycotted companies
time.optimize.ssr = 2021:2020,
time.plot = 2021:2025
)
###################################################
### chunk number 1:
###################################################
library("Synth")
library(readr)
library('dplyr')
df <- read_csv("merged_dataset.csv")
id_cols <- c("boycotted", "ticker", "fy", "fp", "end")
# Step 2: Convert all other columns to numeric
df_clean <- df %>%
mutate(across(
.cols = -all_of(id_cols),          # all columns except identifiers
.fns  = ~ as.numeric(.)  # convert to numeric, quietly
))
###################################################
### chunk number 2:
###################################################
df_clean[85:89, 1:4]
###################################################
### chunk number 3:
###################################################
dataprep.out <- dataprep(
foo = df_clean,
predictors = c("assets", "employees", "gross_margin_pct", "net_margin_pct",
"r_and_d", "long_term_debt", "operating_expenses"),
predictors.op = "mean",
time.predictors.prior = 2021:2023,  # pre-boycott quarters
special.predictors = list(
list("revenue", 2021:2020, "mean"),   # Include mean past revenue
list("net_income", 2021:2020, "mean")
),
dependent = "revenue",
unit.variable = "company_id",
unit.names.variable = "ticker",
time.variable = "year",
treatment.identifier = 1,         # Boycotted company
controls.identifier = c(2:20),    # Non-boycotted companies
time.optimize.ssr = 2021:2020,
time.plot = 2021:2025
)
###################################################
### chunk number 3:
###################################################
dataprep.out <- dataprep(
foo = df_clean,
predictors = c("assets", "employees", "gross_margin_pct", "net_margin_pct",
"r_and_d", "long_term_debt", "operating_expenses"),
predictors.op = "mean",
time.predictors.prior = 2021:2023,  # pre-boycott quarters
special.predictors = list(
list("revenue", 2021:2020, "mean"),   # Include mean past revenue
list("net_income", 2021:2020, "mean")
),
dependent = "revenue",
unit.variable = "ticker",
time.variable = "fy",
treatment.identifier = 1,         # Boycotted company
controls.identifier = c(2:20),    # Non-boycotted companies
time.optimize.ssr = 2021:2020,
time.plot = 2021:2025
)
df <- df_clean %>%
mutate(company_id = as.numeric(as.factor(ticker)))  # creates 1, 2, 3, ...
###################################################
### chunk number 2:
###################################################
df_clean[85:89, 1:4]
###################################################
### chunk number 3:
###################################################
dataprep.out <- dataprep(
foo = df_clean,
predictors = c("assets", "employees", "gross_margin_pct", "net_margin_pct",
"r_and_d", "long_term_debt", "operating_expenses"),
predictors.op = "mean",
time.predictors.prior = 2021:2023,  # pre-boycott quarters
special.predictors = list(
list("revenue", 2021:2020, "mean"),   # Include mean past revenue
list("net_income", 2021:2020, "mean")
),
dependent = "revenue",
unit.variable = "ticker",
time.variable = "fy",
treatment.identifier = 1,         # Boycotted company
controls.identifier = c(2:20),    # Non-boycotted companies
time.optimize.ssr = 2021:2020,
time.plot = 2021:2025
)
###################################################
### chunk number 1:
###################################################
library("Synth")
library(readr)
library('dplyr')
df <- read_csv("data/merged_dataset_2025-11-01_16-55.csv")
id_cols <- c("boycotted", "ticker", "fy", "fp", "end")
# Step 2: Convert all other columns to numeric
df_clean <- df %>%
mutate(across(
.cols = -all_of(id_cols),          # all columns except identifiers
.fns  = ~ as.numeric(.))) %>%      # convert to numeric, quietly
mutate(company_id = as.numeric(as.factor(ticker)),  # creates 1, 2, 3, ...
sector_code = as.numeric(as.factor(sector))) # creates numeric codes for sector
# Step 2: Convert all other columns to numeric
df_clean <- df %>%
mutate(across(
.cols = -all_of(id_cols),          # all columns except identifiers
.fns  = ~ as.numeric(.))) %>%      # convert to numeric, quietly
mutate(company_id = as.numeric(as.factor(ticker)))
df_clean
df_clean %>% View()
# Step 2: Convert all other columns to numeric
df_clean <- df %>%
mutate(across(
.cols = -all_of(id_cols),          # all columns except identifiers
.fns  = ~ as.numeric(.))) %>%      # convert to numeric, quietly
mutate(company_id = as.numeric(as.factor(ticker)))
###################################################
### chunk number 2:
###################################################
df_clean[85:89, 1:4]
###################################################
### chunk number 3:
###################################################
dataprep.out <- dataprep(
foo = df_clean,
predictors = c("assets", "employees", "gross_margin_pct", "net_margin_pct",
"r_and_d", "long_term_debt", "operating_expenses"),
predictors.op = "mean",
time.predictors.prior = 2021:2023,  # pre-boycott quarters
special.predictors = list(
list("revenue", 2021:2020, "mean"),   # Include mean past revenue
list("net_income", 2021:2020, "mean")
),
dependent = "revenue",
unit.variable = "ticker",
time.variable = "fy",
treatment.identifier = 1,         # Boycotted company
controls.identifier = c(2:20),    # Non-boycotted companies
time.optimize.ssr = 2021:2020,
time.plot = 2021:2025
)
dataprep.out <- dataprep(
foo = df_clean,
predictors = c("assets", "employees", "gross_margin_pct", "net_margin_pct",
"r_and_d", "long_term_debt", "operating_expenses"),
predictors.op = "mean")
dataprep.out <- dataprep(
foo = df_clean,
predictors = c("assets", "employees", "gross_margin_pct", "net_margin_pct",
"r_and_d", "long_term_debt", "operating_expenses"))
dataprep.out <- dataprep(
foo = df_clean,
predictors = c("assets", "employees", "gross_margin_pct", "net_margin_pct",
"r_and_d", "long_term_debt"))
dataprep.out <- dataprep(
foo = df_clean,
predictors = c("assets", "employees", "gross_margin_pct", "net_margin_pct",
"r_and_d"))
dataprep.out <- dataprep(
foo = df_clean,
predictors = c("assets", "employees", "gross_margin_pct", "net_margin_pct"))
dataprep.out <- dataprep(
foo = df_clean,
predictors = c("assets", "employees", "gross_margin_pct"))
dataprep.out <- dataprep(
foo = df_clean,
predictors = c("assets", "employees"))
dataprep.out <- dataprep(
foo = df_clean,
predictors = c("assets"))
dataprep.out <- dataprep(
foo = df_clean,
predictors = c("assets", "employees"))
dataprep.out <- dataprep(
foo = df_clean))
dataprep.out <- dataprep(
foo = df_clean)
dataprep.out <- dataprep(foo = df_clean)
?dataprep()
dataprep(foo = df_clean, predictors = NULL,
predictors.op = "mean", special.predictors = NULL,
dependent = NULL, unit.variable = NULL,
time.variable = NULL, treatment.identifier = NULL,
controls.identifier = NULL, time.predictors.prior = NULL,
time.optimize.ssr = NULL, time.plot = time.optimize.ssr,
unit.names.variable = NA)
df_clean %>% View()
id_cols <- c("boycotted", "ticker", "fp", "end")
# Step 2: Convert all other columns to numeric
df_clean <- df %>%
mutate(across(
.cols = -all_of(id_cols),          # all columns except identifiers
.fns  = ~ as.numeric(.))) %>%      # convert to numeric, quietly
mutate(company_id = as.numeric(as.factor(ticker)))
###################################################
### chunk number 2:
###################################################
df_clean[85:89, 1:4]
dataprep.out <- dataprep(
foo = df_clean,
predictors = c("assets", "employees", "gross_margin_pct", "net_margin_pct",
"r_and_d", "long_term_debt", "operating_expenses"),
predictors.op = "mean",
time.predictors.prior = 2021:2023,  # pre-boycott quarters
special.predictors = list(
list("revenue", 2021:2020, "mean"),   # Include mean past revenue
list("net_income", 2021:2020, "mean")
),
dependent = "revenue",
unit.variable = "ticker",
time.variable = "fy",
treatment.identifier = 1,         # Boycotted company
controls.identifier = c(2:20),    # Non-boycotted companies
time.optimize.ssr = 2021:2020,
time.plot = 2021:2025
)
str(df_clean)
data(synth.data)
str(synth.data)
data("basque")
str(basque)
str(df_clean)
df_clean <- select("boycotted", "assets", "company_id ")
df_clean <- select("boycotted", "assets", "company_id")
df_clean <- df_clean %>% select("boycotted", "assets", "company_id")
df_clean
dataprep.out <- dataprep(
foo = df_clean)
###################################################
### chunk number 1:
###################################################
library("Synth")
library(readr)
library('dplyr')
df <- read_csv("data/merged_dataset_2025-11-01_16-55.csv")
id_cols <- c("boycotted", "ticker", "fp", "end")
# Step 2: Convert all other columns to numeric
df_clean <- df %>%
mutate(across(
.cols = -all_of(id_cols),          # all columns except identifiers
.fns  = ~ as.numeric(.))) %>%      # convert to numeric, quietly
mutate(company_id = as.numeric(as.factor(ticker)))
class(df_clean)
# Step 2: Convert all other columns to numeric
df_clean <- df %>%
mutate(across(
.cols = -all_of(id_cols),          # all columns except identifiers
.fns  = ~ as.numeric(.))) %>%      # convert to numeric, quietly
mutate(company_id = as.numeric(as.factor(ticker))) %>% as.data.frame()
class(df_clean)
###################################################
### chunk number 2:
###################################################
df_clean[85:89, 1:4]
dataprep.out <- dataprep(
foo = df_clean,
predictors = c("assets", "employees", "gross_margin_pct", "net_margin_pct",
"r_and_d", "long_term_debt", "operating_expenses"),
predictors.op = "mean",
time.predictors.prior = 2021:2023,  # pre-boycott quarters
special.predictors = list(
list("revenue", 2021:2020, "mean"),   # Include mean past revenue
list("net_income", 2021:2020, "mean")
),
dependent = "revenue",
unit.variable = "ticker",
time.variable = "fy",
treatment.identifier = 1,         # Boycotted company
controls.identifier = c(2:20),    # Non-boycotted companies
time.optimize.ssr = 2021:2020,
time.plot = 2021:2025
)
# Step 2: Convert all other columns to numeric
df_clean <- df %>%
mutate(across(
.cols = -all_of(id_cols),          # all columns except identifiers
.fns  = ~ as.numeric(.))) %>%      # convert to numeric, quietly
mutate(company_id = as.numeric(as.factor(ticker))) %>% as.data.frame()
dataprep.out <- dataprep(
foo = df_clean)
class(df_clean)
str(df_clean)
df_clean <- df_clean %>%
select(-end)
dataprep.out <- dataprep(
foo = df_clean)
df_clean <- df_clean %>%
select(-ticker)
dataprep.out <- dataprep(
foo = df_clean)
df_clean <- df_clean %>%
select(-fp)
dataprep.out <- dataprep(
foo = df_clean)
str(df_clean)
###################################################
### chunk number 1:
###################################################
library("Synth")
library(readr)
library('dplyr')
df <- read_csv("data/merged_dataset_2025-11-01_16-55.csv")
id_cols <- c("boycotted", "ticker", "fp", "end")
# Step 2: Convert all other columns to numeric
df_clean <- df %>%
mutate(across(
.cols = -all_of(id_cols),          # all columns except identifiers
.fns  = ~ as.numeric(.))) %>%      # convert to numeric, quietly
mutate(company_id = as.numeric(as.factor(ticker))) %>% as.data.frame()
dataprep(
foo = df_clean,
predictors = c("assets", "employees", "gross_margin_pct", "net_margin_pct",
"r_and_d", "long_term_debt", "operating_expenses"),
dependent = "revenue",
unit.variable = "company_id",          # numeric ID column
unit.names.variable = "ticker",        # readable name
time.variable = "fy",                  # or numeric time index
treatment.identifier = 1,              # treated company ID
controls.identifier = c(2:20),         # control company IDs
time.optimize.ssr = 2020:2021,         # pre-treatment period
time.plot = 2020:2025                  # full period to plot
)
df_clean %>%  View()
# Step 2: Convert all other columns to numeric
df_clean <- df %>%
mutate(across(
.cols = -all_of(id_cols),          # all columns except identifiers
.fns  = ~ as.numeric(.))) %>%      # convert to numeric, quietly
mutate(company_id = as.numeric(as.factor(ticker))) %>%
filter(ticker != "COKE") #make sure there just one target
# Step 2: Convert all other columns to numeric
df_clean <- df %>%
mutate(across(
.cols = -all_of(id_cols),          # all columns except identifiers
.fns  = ~ as.numeric(.))) %>%      # convert to numeric, quietly
mutate(company_id = as.numeric(as.factor(ticker))) %>%
filter(ticker != "COKE") %>% #make sure there just one target
as.data.frame()
###################################################
### chunk number 1:
###################################################
library("Synth")
library(readr)
library('dplyr')
df <- read_csv("data/merged_dataset_2025-11-01_16-55.csv")
id_cols <- c("boycotted", "ticker", "fp", "end")
# Step 2: Convert all other columns to numeric
df_clean <- df %>%
mutate(across(
.cols = -all_of(id_cols),          # all columns except identifiers
.fns  = ~ as.numeric(.))) %>%      # convert to numeric, quietly
mutate(company_id = as.numeric(as.factor(ticker))) %>%
filter(ticker != "COKE") %>% #make sure there just one target
as.data.frame()
dataprep(
foo = df_clean,
predictors = c("assets", "employees", "gross_margin_pct", "net_margin_pct",
"r_and_d", "long_term_debt", "operating_expenses"),
dependent = "revenue",
unit.variable = "company_id",          # numeric ID column
unit.names.variable = "ticker",        # readable name
time.variable = "fy",                  # or numeric time index
treatment.identifier = 1,              # treated company ID
controls.identifier = c(2:20),         # control company IDs
time.optimize.ssr = 2020:2021,         # pre-treatment period
time.plot = 2020:2025                  # full period to plot
)
dataprep(
foo = df_clean,
predictors = c("assets", "employees",  "net_margin_pct",
"r_and_d", "long_term_debt", "operating_expenses"),
dependent = "revenue",
unit.variable = "company_id",          # numeric ID column
unit.names.variable = "ticker",        # readable name
time.variable = "fy",                  # or numeric time index
treatment.identifier = 1,              # treated company ID
controls.identifier = c(2:20),         # control company IDs
time.optimize.ssr = 2020:2021,         # pre-treatment period
time.plot = 2020:2025                  # full period to plot
)
df_clean %>% View()
dataprep(
foo = df_clean,
predictors = c("assets", "employees",  "net_margin_pct",
"r_and_d", "long_term_debt", "operating_expenses"),
dependent = "revenue",
unit.variable = "company_id",          # numeric ID column
unit.names.variable = "ticker",        # readable name
time.variable = "fy",                  # or numeric time index
treatment.identifier = 6,              # treated company ID
controls.identifier = c(1:5,7),         # control company IDs
time.optimize.ssr = 2006:2021,         # pre-treatment period
time.plot = 2006:2025                  # full period to plot
)
dataprep(
foo = df_clean,
predictors = c("assets", "employees",  "net_margin_pct",
"r_and_d", "long_term_debt", "operating_expenses"),
dependent = "revenue",
unit.variable = "company_id",          # numeric ID column
unit.names.variable = "ticker",        # readable name
time.variable = "fy",                  # or numeric time index
treatment.identifier = 6,              # treated company ID
controls.identifier = c(1,2,4,5,7),         # control company IDs
time.optimize.ssr = 2006:2021,         # pre-treatment period
time.plot = 2006:2025                  # full period to plot
)
###################################################
### chunk number 1:
###################################################
library("Synth")
library(readr)
library('dplyr')
df <- read_csv("data/merged_dataset_2025-11-01_16-55.csv")
id_cols <- c("boycotted", "ticker", "fp", "end")
# Step 2: Convert all other columns to numeric
df_clean <- df %>%
mutate(across(
.cols = -all_of(id_cols),          # all columns except identifiers
.fns  = ~ as.numeric(.))) %>%      # convert to numeric, quietly
mutate(company_id = as.numeric(as.factor(ticker))) %>%
filter(ticker != "COKE") %>% #make sure there just one target
as.data.frame()
df_clean %>%  View()
